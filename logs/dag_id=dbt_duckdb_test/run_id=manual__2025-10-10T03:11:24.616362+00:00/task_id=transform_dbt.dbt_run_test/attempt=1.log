{"timestamp":"2025-10-10T03:11:34.533636Z","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager","filename":"manager.py","lineno":179}
{"timestamp":"2025-10-10T03:11:34.534068Z","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/assignment.py","logger":"airflow.models.dagbag.DagBag","filename":"dagbag.py","lineno":593}
{"timestamp":"2025-10-10T03:11:34.576747Z","level":"info","event":"[cmd] dbt run --profiles-dir /opt/airflow/dbt/profiles --project-dir /opt/airflow/dbt --vars csv_uri: '/opt/airflow/data/raw/cdc_data.csv'","logger":"unusual_prefix_d7f801932ebfc3226b51a346e6115af67ccae32b_assignment","filename":"assignment.py","lineno":49}
{"timestamp":"2025-10-10T03:11:41.354541Z","level":"info","event":"--- STDOUT ---\n\u001b[0m03:11:35  Running with dbt=1.10.13\n\u001b[0m03:11:35  Registered adapter: duckdb=1.9.6\n\u001b[0m03:11:35  Unable to do partial parsing because config vars, config profile, or config target have changed\n\u001b[0m03:11:36  [\u001b[33mWARNING\u001b[0m]: Did not find matching node for patch with name 'stg_raw_cdi' in the 'models' section of file 'models/schema.yml'\n\u001b[0m03:11:36  [\u001b[33mWARNING\u001b[0m]: Did not find matching node for patch with name 'stg_cdi_normallized' in the 'models' section of file 'models/schema.yml'\n\u001b[0m03:11:36  [\u001b[33mWARNING\u001b[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated\nfunctionality\nFound top-level arguments to test `relationships`. Arguments to generic tests\nshould be nested under the `arguments` property.`\n\u001b[0m03:11:36  [\u001b[33mWARNING\u001b[0m]: Test 'test.data_eng_assignment.not_null_stg_cdi_normallized_location_id.50ed157eff' (models/schema.yml) depends on a node named 'stg_cdi_normallized' in package '' which was not found\n\u001b[0m03:11:36  [\u001b[33mWARNING\u001b[0m]: Test 'test.data_eng_assignment.not_null_stg_cdi_normallized_topic_id.f5d8329834' (models/schema.yml) depends on a node named 'stg_cdi_normallized' in package '' which was not found\n\u001b[0m03:11:36  [\u001b[33mWARNING\u001b[0m]: Test 'test.data_eng_assignment.not_null_stg_cdi_normallized_question_id.fac6a8c30d' (models/schema.yml) depends on a node named 'stg_cdi_normallized' in package '' which was not found\n\u001b[0m03:11:36  [\u001b[33mWARNING\u001b[0m]: Test 'test.data_eng_assignment.not_null_stg_cdi_normallized_value_type_id.4401762c10' (models/schema.yml) depends on a node named 'stg_cdi_normallized' in package '' which was not found\n\u001b[0m03:11:36  [\u001b[33mWARNING\u001b[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.\nThere are 1 unused configuration paths:\n- models.data_eng_assignment.dim\n\u001b[0m03:11:36  Found 11 models, 13 data tests, 560 macros\n\u001b[0m03:11:36  \n\u001b[0m03:11:36  Concurrency: 4 threads (target='dev')\n\u001b[0m03:11:36  \n\u001b[0m03:11:36  1 of 11 START sql view model analytics_analytics.stg_cdi_raw ................... [RUN]\n\u001b[0m03:11:37  1 of 11 OK created sql view model analytics_analytics.stg_cdi_raw .............. [\u001b[32mOK\u001b[0m in 0.25s]\n\u001b[0m03:11:37  2 of 11 START sql view model analytics_analytics.stg_cdi_clean ................. [RUN]\n\u001b[0m03:11:37  2 of 11 OK created sql view model analytics_analytics.stg_cdi_clean ............ [\u001b[32mOK\u001b[0m in 0.23s]\n\u001b[0m03:11:37  3 of 11 START sql view model analytics_analytics.dim_location .................. [RUN]\n\u001b[0m03:11:37  4 of 11 START sql view model analytics_analytics.dim_question .................. [RUN]\n\u001b[0m03:11:37  5 of 11 START sql view model analytics_analytics.dim_response .................. [RUN]\n\u001b[0m03:11:37  6 of 11 START sql view model analytics_analytics.dim_strat_category ............ [RUN]\n\u001b[0m03:11:37  3 of 11 OK created sql view model analytics_analytics.dim_location ............. [\u001b[32mOK\u001b[0m in 0.41s]\n\u001b[0m03:11:37  7 of 11 START sql view model analytics_analytics.dim_strat_value ............... [RUN]\n\u001b[0m03:11:37  4 of 11 OK created sql view model analytics_analytics.dim_question ............. [\u001b[32mOK\u001b[0m in 0.45s]\n\u001b[0m03:11:37  5 of 11 OK created sql view model analytics_analytics.dim_response ............. [\u001b[32mOK\u001b[0m in 0.45s]\n\u001b[0m03:11:37  8 of 11 START sql view model analytics_analytics.dim_topic ..................... [RUN]\n\u001b[0m03:11:37  9 of 11 START sql view model analytics_analytics.dim_value_type ................ [RUN]\n\u001b[0m03:11:38  8 of 11 OK created sql view model analytics_analytics.dim_topic ................ [\u001b[32mOK\u001b[0m in 0.51s]\n\u001b[0m03:11:38  10 of 11 START sql view model analytics_analytics.stg_cdi_normalized ........... [RUN]\n\u001b[0m03:11:38  9 of 11 OK created sql view model analytics_analytics.dim_value_type ........... [\u001b[32mOK\u001b[0m in 0.51s]\n\u001b[0m03:11:38  6 of 11 OK created sql view model analytics_analytics.dim_strat_category ....... [\u001b[32mOK\u001b[0m in 1.14s]\n\u001b[0m03:11:38  10 of 11 OK created sql view model analytics_analytics.stg_cdi_normalized ...... [\u001b[32mOK\u001b[0m in 0.33s]\n\u001b[0m03:11:38  11 of 11 START sql table model analytics_analytics.agg_norm_question ........... [RUN]\n\u001b[0m03:11:38  7 of 11 OK created sql view model analytics_analytics.dim_strat_value .......... [\u001b[32mOK\u001b[0m in 1.04s]\n\u001b[0m03:11:39  11 of 11 ERROR creating sql table model analytics_analytics.agg_norm_question .. [\u001b[31mERROR\u001b[0m in 0.89s]\n\u001b[0m03:11:39  \n\u001b[0m03:11:39  Finished running 1 table model, 10 view models in 0 hours 0 minutes and 2.86 seconds (2.86s).\n\u001b[0m03:11:39  \n\u001b[0m03:11:39  \u001b[31mCompleted with 1 error, 0 partial successes, and 0 warnings:\u001b[0m\n\u001b[0m03:11:39  \n\u001b[0m03:11:39  \u001b[31mFailure in model agg_norm_question (models/marts/agg_norm_question.sql)\u001b[0m\n\u001b[0m03:11:39    Runtime Error in model agg_norm_question (models/marts/agg_norm_question.sql)\n  IO Error: Cannot open file \"/data/parquet/agg_norm_question.parquet\": No such file or directory\n\u001b[0m03:11:39  \n\u001b[0m03:11:39    compiled code at target/compiled/data_eng_assignment/models/marts/agg_norm_question.sql\n\u001b[0m03:11:39  \n\u001b[0m03:11:39  Done. PASS=10 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=11\n\u001b[0m03:11:39  [\u001b[33mWARNING\u001b[0m][DeprecationsSummary]: Deprecated functionality\nSummary of encountered deprecations:\n- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences\nTo see all deprecation instances instead of just the first occurrence of each,\nrun command again with the `--show-all-deprecations` flag. You may also need to\nrun with `--no-partial-parse` as some deprecations are only encountered during\nparsing.\n","logger":"unusual_prefix_d7f801932ebfc3226b51a346e6115af67ccae32b_assignment","filename":"assignment.py","lineno":59}
{"timestamp":"2025-10-10T03:11:41.355855Z","level":"error","event":"Task failed with exception","logger":"task","filename":"task_runner.py","lineno":994,"error_detail":[{"exc_type":"CalledProcessError","exc_value":"Command '['dbt', 'run', '--profiles-dir', '/opt/airflow/dbt/profiles', '--project-dir', '/opt/airflow/dbt', '--vars', \"csv_uri: '/opt/airflow/data/raw/cdc_data.csv'\"]' returned non-zero exit status 1.","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":920,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1302,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":416,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/decorator.py","lineno":252,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":416,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":216,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":239,"name":"execute_callable"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/callback_runner.py","lineno":82,"name":"run"},{"filename":"/opt/airflow/dags/assignment.py","lineno":156,"name":"dbt_run_test"},{"filename":"/opt/airflow/dags/assignment.py","lineno":63,"name":"_run"}],"is_group":false,"exceptions":[]}]}
